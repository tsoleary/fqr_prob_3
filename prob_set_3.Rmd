---
title: "Problem Set 3"
author: "Thomas O'Leary and Amanda Jones"
date: "9/23/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Structured population models

```{r comadre, echo = TRUE, eval = TRUE}
load("COMADRE_v.3.0.0.RData")
# save stage transition matrix for the whales
whale_mat <- comadre$mat[2136][[1]]$matA
```

### Sperm whales

We are looking _Physeter macrocephalus occupying_, specifically a population of sperm whales in the Caribbean, to attempt to determine whether or not that population is expected to increase in size over time. We want to look at the the proportion between age classes, in this case, unweaned calves and adults (excluding mature males). We are also curious how small changes in birth, and survival rates will impact growth trends. We would like to know if the population is healthy/stable and if it is not, which life stage will have the greatest impact for conservation strategies. 

### Eigenvalue

```{r eigenvalue, echo = TRUE, eval = TRUE}
eigenvalue <- eigen(whale_mat)
dom_eigen <- max(eigenvalue$values)
```

### Stable age distribution (i.e. eigenvector)

```{r eigenvector, echo = FALSE, eval = TRUE}
# get the eigenvector associated with dominant eigenvalue
# first value refers to the calves and second value refers to the adults
eigenvector <- eigenvalue$vectors[, 1]

# calculate the stable age distribution of calves to adults
stable_age_ratio <- eigenvector[2]/eigenvector[1]

prop_calves <- round(eigenvector[1]/(eigenvector[1] + eigenvector[2]), 
                     digits = 3)
prop_adults <- round(eigenvector[2]/(eigenvector[1] + eigenvector[2]), 
                     digits = 3)
```
There is a stable age distribution of approximately 79% adults and 21% unweaned calves.

```{r, echo = TRUE, eval = TRUE}
stable_age_ratio
prop_calves
prop_adults


```


### Elasticity




### Sensitivity

### What does this tell you about the population?

### Address question proposed using eigenvalue, eigenvector, elastisity, & sensitivity

